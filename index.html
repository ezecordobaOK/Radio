<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Radio en Vivo - YouTube Audio</title>
<style>
    body { font-family: Arial; background:#111; color:#fff; padding:20px; }
    .card { max-width:600px; margin:auto; background:#1e1e1e; padding:20px;
            border-radius:10px; box-shadow:0 0 10px #000; }
    input, button { padding:10px; margin-top:10px; width:100%; border-radius:6px; border:none; }
    button { background:#0078ff; color:#fff; cursor:pointer; }
    button:hover { opacity:0.9; }
    #status { margin-top:10px; font-size:14px; }
    #player { width:1px; height:1px; opacity:0; border:0; }
</style>
</head>
<body>

<div class="card">
    <h2>Radio â€” Audio desde YouTube Live</h2>

    <label>ðŸ“º PegÃ¡ el enlace del vivo de YouTube:</label>
    <input type="text" id="yturl" placeholder="https://youtube.com/live/XXXXXXXXX" />

    <button onclick="loadVideo()">Cargar transmisiÃ³n</button>
    <button onclick="togglePlay()">â–¶ Reproducir / Detener</button>
    <button onclick="toggleMute()">ðŸ”‡ Silencio (M)</button>

    <div id="status">Estado: esperandoâ€¦</div>

    <div id="player"></div>
</div>

<!-- API oficial de YouTube -->
<script src="https://www.youtube.com/iframe_api"></script>

<script>
let player;
let isMuted = true;
let isPlaying = false;

function extractID(url) {
    return url.split("live/")[1]?.split("?")[0] ||
           url.split("v=")[1]?.split("&")[0] || "";
}

// YouTube API carga este callback automÃ¡ticamente
function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
        height: '1',
        width: '1',
        videoId: '',
        playerVars: {
            autoplay: 1,
            controls: 0,
            mute: 1,
            rel: 0,
            playsinline: 1
        },
        events: {
            onReady: () => document.getElementById("status").textContent = "Listo para cargar transmisiÃ³n"
        }
    });
}

function loadVideo() {
    const url = document.getElementById("yturl").value.trim();
    const id = extractID(url);

    if (!id) {
        document.getElementById("status").textContent = "Error: enlace invÃ¡lido";
        return;
    }

    player.loadVideoById(id);
    player.mute();
    isMuted = true;
    isPlaying = true;

    document.getElementById("status").textContent = "Cargando transmisiÃ³nâ€¦";
}

function togglePlay() {
    if (isPlaying) player.pauseVideo();
    else player.playVideo();

    isPlaying = !isPlaying;

    document.getElementById("status").textContent =
        isPlaying ? "Reproduciendoâ€¦" : "Detenido";
}

function toggleMute() {
    if (isMuted) player.unMute();
    else player.mute();

    isMuted = !isMuted;

    document.getElementById("status").textContent =
        isMuted ? "Silenciado" : "Con sonido";
}

document.addEventListener("keydown", e => {
    if (e.key.toLowerCase() === "m") toggleMute();
    if (e.key.toLowerCase() === "a") togglePlay();
});
</script>

</body>
</html>
